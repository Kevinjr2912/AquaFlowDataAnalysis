from scipy.interpolate import interp1d
import numpy as np

# Interpolaci贸n para PH
def f_interp_ph():
    x = [
        2, 2.5218504532947223, 2.7445674160261655, 2.997133123326708,
        3.2451067969280913, 3.5344094745213246, 3.8420802869111896, 4.124495089130543,
        4.303586855845702, 4.480383131235852, 4.6066659848861224, 4.726060262463086,
        4.843159048715041, 4.971738094389748, 5.091132371966712, 5.208231158218666,
        5.320737560421749, 5.442428730722576, 5.577895651771162, 5.692698245998681,
        5.823573483697825, 5.945263953299223, 6.08073087434781, 6.186349401177013,
        6.296559611355661, 6.4182507816564875, 6.535349567908442, 6.645559778087089,
        6.74658592086742, 6.831540120875555, 6.914198128859255, 7.026704531062338,
        7.212684873850804, 7.497395167395165, 7.662710482663137, 7.839506758053286,
        7.988750130549061, 8.078296013906641, 8.179322156686972, 8.275756616117858,
        8.374486566873754, 8.482401285727393, 8.61786820677598, 8.695933830710807,
        8.803848549564446, 8.88880274957258, 8.996716767726792, 9.090162043399289,
        9.184993302539695, 9.279131569946145, 9.375565328677606, 9.474295980132927,
        9.607467409856506, 9.768191041775033, 9.903657262124192, 10.05519752734383,
        10.225104525961246, 10.373927478800425, 10.504676590602589, 10.713302838193542,
        10.939914638693622, 11.170122428656446, 11.367957905061463, 11.558600001142139,
        11.720465773127748, 12
    ]

    y = [
        0, 2.3796197618577972, 3.4143280047365683, 4.492151832116362,
        6.130438786921987, 7.639392145253698, 8.84656272613656, 11.002210380896122,
        12.94229327017975, 15.141043352411206, 18.158950069074603, 21.34931912374209,
        24.53967502138045, 27.77314650351982, 30.963502401158152, 34.58499440826301,
        37.68912571541388, 41.1381619630292, 44.54408262614351, 47.389540161831974,
        50.536787053483884, 53.68402736662121, 57.43485954871453, 60.927004802316304,
        64.33293204394518, 68.25620682849888, 72.48127754753057, 76.53389250707275,
        80.50028945464203, 83.73376093678141, 87.09656601539467, 90.15758831655911,
        91.96833432011152, 94.08086639037009, 91.66654167489081, 88.6055193737264,
        86.49298730346783, 82.69904611538806, 78.90510492730829, 75.240503914217,
        71.4465693046518, 67.3508387606086, 63.34133280705287, 60.15097033089994,
        56.57260048681069, 53.20978882968285, 49.846977172554986, 46.39505953555738,
        43.12135385829927, 39.672317610683955, 35.921492007105186, 32.2568909940139,
        28.85097033089961, 25.66061443326125, 22.427142951121883, 19.624800999934422,
        16.736227879744938, 14.43424774685891, 12.221972238668666, 10.668534964805062,
        8.98000131570301, 7.223932636010873, 5.332793895138544, 3.9819617130452407,
        2.901309124399756, 2.0232747845536756
    ]

    x_np = np.array(x)
    y_np = np.array(y)
    
    sorted_idx = np.argsort(x_np)
    x_sorted = x_np[sorted_idx]
    y_sorted = y_np[sorted_idx]

    x_unique, unique_indices = np.unique(x_sorted, return_index=True)
    y_unique = y_sorted[unique_indices]

    f = interp1d(x_unique, y_unique, kind='cubic', fill_value='extrapolate')

    def interpolated(ph):
        if ph <= 2:
            return 2
        elif ph >= 10:
            return 3
        return float(f(ph))

    return interpolated


# Interpolaci贸n para TDS 
def f_interp_tds():
    x = [
        0, 5.87422730637579, 11.74844670391203, 17.62266610144827, 23.842430607841774,
        29.3711128053603, 35.24533220289654, 41.46509670929004, 47.33932401566584,
        52.86799830434481, 59.087762810738305, 66.34415473486408, 73.25500945897211,
        80.85693858311558, 87.76779330722363, 95.02418523134938, 101.58948693776058,
        108.15480446185093, 115.06564336827988, 120.59433347463792, 127.8507253987637,
        134.76156430519265, 141.32688182928297, 148.92881095342645, 155.8396656775345,
        162.4049673839457, 169.66137512575057, 177.26328843221495, 185.55630777407293,
        193.1582527158955, 199.72357023998583, 207.32548354645022, 215.96405590600503,
        223.9115222301662, 234.62334942518555, 243.2619217847404, 250.17276069116932,
        257.7747056329919, 265.37661893945625, 274.01519129901106, 282.9992850409045,
        290.9467830004239, 298.2031749245497, 307.5328216841399, 317.89909586146246,
        328.2653700387849, 337.24946378067835, 344.85140872250105, 353.48994944669766,
        361.437447406217, 369.3849137303782, 378.3690074722716, 388.7352816495942,
        397.7194070268459, 406.3579477510425, 414.9965201105972, 423.2895394524553,
        430.20037835888417, 438.83898235379723, 446.78641704260025, 455.4250210375132,
        463.7180403793712, 472.0110597212293, 479.6129730276936, 486.52384356948085,
        500
    ]

    y = [
        78, 79.1373626850406, 80.02197907089314, 80.90659545674568, 81.9175835459608,
        82.80219993181333, 83.68681342520298, 84.69780440688099, 85.58241790027066,
        85.83516709192159, 85.58241790027066, 85.20329700525711, 85.07692530189453,
        84.82417611024358, 84.57142981105552, 84.19230891604198, 83.81318802102845,
        82.92857163517593, 81.9175835459608, 81.15934175593374, 80.2747253700812,
        79.26373728086607, 78.37912089501353, 77.36813280579841, 76.48351641994587,
        75.72527462991881, 74.96703283989174, 74.08241934650209, 73.07142836482407,
        72.18681487143444, 71.55494478476996, 70.79670299474289, 69.91208950135324,
        69.15384771132616, 68.14285672964816, 67.3846149396211, 66.75274485295662,
        65.48901046455344, 64.22527607615025, 62.961535902821296, 61.57142981105552,
        60.18131793436398, 59.17032695268598, 57.90659256428279, 56.76922987924219,
        55.63186719420159, 54.494504509161004, 53.73626271913393, 52.72527173745593,
        51.840658244066276, 50.956044750676625, 49.94505376899862, 48.68131938059542,
        47.79670010228001, 46.532965713876834, 45.14285383718528, 43.8791194487821,
        42.7417567637415, 41.47802237533832, 40.21428220200936, 38.95054781360618,
        37.56043593691464, 36.29670154851144, 35.032967160108264, 34.021976178430265,
        33.01098519675225
    ]

    x_np = np.array(x)
    y_np = np.array(y)

    sorted_idx = np.argsort(x_np)
    x_sorted = x_np[sorted_idx]
    y_sorted = y_np[sorted_idx]

    x_unique, unique_indices = np.unique(x_sorted, return_index=True)
    y_unique = y_sorted[unique_indices]

    f = interp1d(x_unique, y_unique, kind='cubic', fill_value='extrapolate')

    def interpolated(tds):
        if tds > 500:
            return 3
        return float(f(tds))

    return interpolated

# Interpolaci贸n para Temperatura
def f_interp_temp():
    x = [
        -5, -4.562398703403566, -4.2058346839546195, -3.833063209076175, -3.4764991896272286,
        -3.1037277147487847, -2.6985413290113454, -2.293354943273906, -1.8557536466774716,
        -1.46677471636953, -1.1264181523500811, -0.769854132901135, -0.3808752025931934,
        0.008103727714749098, 0.3646677471636952, 0.705024311183144, 1.0453808752025928,
        1.353322528363047, 1.6612641815235003, 1.9692058346839545, 2.3095623987034033,
        2.633711507293355, 2.925445705024311, 3.2009724473257695, 3.46029173419773,
        3.703403565640194, 3.9627228525121563, 4.238249594813613, 4.513776337115072,
        4.821717990275527, 5.178282009724473, 5.583468395461912, 6.037277147487844,
        6.426256077795786, 6.847649918962723, 7.252836304700162, 7.641815235008103,
        8.095623987034035, 8.53322528363047, 8.987034035656402, 9.440842787682334,
        9.910858995137763, 10.413290113452188, 10.883306320907618, 11.434359805510535,
        11.92058346839546, 12.423014586709886, 12.893030794165316, 13.379254457050244,
        13.84927066450567, 14.3192868719611, 15
    ]

    y = [
        56, 59.11258278145695, 62.06953642384106, 64.87086092715232, 67.67218543046357,
        70.62913907284768, 73.58609271523179, 76.69867549668874, 79.96688741721854,
        82.92384105960265, 85.56953642384106, 88.37086092715231, 91.17218543046357,
        93.97350993377484, 91.32781456953643, 88.68211920529801, 85.7251655629139,
        83.3907284768212, 80.90066225165563, 78.56622516556291, 75.76490066225165,
        72.6523178807947, 69.0728476821192, 65.80463576158941, 62.847682119205295,
        59.735099337748345, 56.62251655629139, 53.66556291390729, 50.241721854304636,
        46.66225165562914, 43.39403973509934, 40.59271523178808, 37.79139072847683,
        35.145695364238414, 32.5, 29.85430463576159, 27.675496688741724,
        26.430463576158942, 25.341059602649008, 24.096026490066226, 22.850993377483448,
        21.450331125827816, 20.516556291390728, 19.73841059602649, 18.80463576158941,
        18.026490066225165, 17.248344370860927, 15.847682119205302, 14.291390728476827,
        12.735099337748345, 11.17880794701987, 9
    ]

    x_np = np.array(x)
    y_np = np.array(y)

    sorted_idx = np.argsort(x_np)
    x_sorted = x_np[sorted_idx]
    y_sorted = y_np[sorted_idx]

    x_unique, unique_indices = np.unique(x_sorted, return_index=True)
    y_unique = y_sorted[unique_indices]

    f = interp1d(x_unique, y_unique, kind='cubic', fill_value='extrapolate')

    def interpolated(delta_temp):
        if delta_temp < -5:
            return 1
        elif delta_temp > 15:
            return 9
        return float(f(delta_temp))

    return interpolated

# Interpolaci贸n para Turbidez 
def f_interp_turb():
    x = [
        0, 1.5811850388970456, 3.014065380742228, 4.496360525636757,
        5.830425446772379, 7.411536012376469, 8.893831157270997, 10.474941722875094,
        12.352516282344281, 14.230087295466195, 16.07318781299175, 18.049577793170503,
        19.927148806292408, 22.067195620913633, 24.29062769921358, 26.76111960737113,
        29.679139264632266, 32.52955135727931, 35.14826639650121, 37.66815892231897,
        40.13865792317109, 42.46091251487516, 44.6843445931751, 46.750730228369164,
        49.764735321207574, 52.56294518184038, 55.18166022106227, 57.65215212921982,
        59.978641059580475, 62.15267961291478, 64.37611169121472, 66.59955086220923,
        68.7041519357311, 71.02641362012974, 73.13802936857853, 75.80615921084978,
        78.33119394022873, 81.14756109895345, 83.7662832308699, 86.43441307314114,
        88.71008993962275, 91.2794043611844, 93.35461330842001, 95.18276951849256,
        97.60386080898992, 100
    ]
    y = [
        96.39375652332097, 93.75887511194595, 90.93249957608703, 87.923775014981,
        84.82388084917588, 81.63281053477239, 78.53291309701763, 75.61536141256033,
        72.78898587670142, 69.59791229034828, 66.54957423498112, 63.6320290944231,
        60.80565355856419, 58.78432814321179, 56.869687917739476, 54.590349641772946,
        52.07442977531789, 50.2939329410835, 48.743984222206116, 47.37638780052547,
        46.09995443964466, 44.18530767027307, 42.17949784010166, 40.58480193798193,
        38.12311136481867, 36.87849444221285, 35.69324377382964, 34.96384767284124,
        33.960942757755525, 32.86685515017217, 31.772774086488113, 30.67869302280404,
        29.402272749721774, 28.6728897365319, 27.838490227777072, 26.744402620193725,
        25.650328100408927, 24.647410097524656, 23.46216597304077, 22.55043066265415,
        21.82104764946429, 20.635790437181853, 19.99757702869107, 19.26818092770266,
        18.356445617316055, 17.051775331063652
    ]

    x_np = np.array(x)
    y_np = np.array(y)

    sorted_idx = np.argsort(x_np)
    x_sorted = x_np[sorted_idx]
    y_sorted = y_np[sorted_idx]

    x_unique, unique_indices = np.unique(x_sorted, return_index=True)
    y_unique = y_sorted[unique_indices]

    f = interp1d(x_unique, y_unique, kind='cubic', fill_value='extrapolate')

    def interpolated(turbidez):
        if turbidez > 100:
            return 5
        return float(f(turbidez))

    return interpolated
